ktor {
  deployment {
    projectId = "kloud-test"
    port = 8080
  }

  application {
    modules = [project.kloud.ApplicationKt.isAlive]
  }

  metrics {
    pong {
      descriptor {
        type = "logging.googleapis.com/kloud-test/"
        metricKind = "CUMULATIVE"
        labels = [
          { key = "status", valueType = "STRING", description = "The status of the ping" },
          { key = "ping", valueType = "INT" },
          { key = "pong", valueType = "INT" }
        ]
        description = "A simple ping metric"
      }

      monitoredResource {
        type = "gae_app"
        labels {
          project_id = "kloud-test"
          module_id = "default"
          version_id = "20240908t180235"
          zone = "southamerica-east1"
        }
      }

      timeSeries {
        name = "projects/kloud-test/time_series"
      }
    }
  }

  security {
    google {
      oauth2 {
        id = ${?GOOGLE_CLIENT_ID}
        secret = ${?GOOGLE_CLIENT_SECRET}
        issuer = "https://localhost:8000"
        paths {
          authorize = "/o/oauth2/auth"
          accessToken = "/o/oauth2/token"
        }
        scopes = ["https://localhost:8000/auth/userinfo.profile"]
      }
      apis {
        userInfo {
          host = "accounts.google.com"
          path = "/oauth2/v2/userinfo"
        }
      }
    }
  }
}